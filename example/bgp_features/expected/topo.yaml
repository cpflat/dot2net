name: bgp_features
topology:
  nodes:
    r1:
      kind: linux
      image: quay.io/frrouting/frr:8.5.0
      binds:
      - r1/zebra.conf:/etc/frr/zebra.conf
      - r1/bgpd.conf:/etc/frr/bgpd.conf
      - r1/ospfd.conf:/etc/frr/ospfd.conf
      - r1/ospf6d.conf:/etc/frr/ospf6d.conf
      - r1/daemons:/etc/frr/daemons
      - r1/vtysh.conf:/etc/frr/vtysh.conf
      - r1/frr.log:/var/log/frr.log

      exec:
      - chown frr:frr /var/log/frr.log
    r2:
      kind: linux
      image: quay.io/frrouting/frr:8.5.0
      binds:
      - r2/zebra.conf:/etc/frr/zebra.conf
      - r2/bgpd.conf:/etc/frr/bgpd.conf
      - r2/ospfd.conf:/etc/frr/ospfd.conf
      - r2/ospf6d.conf:/etc/frr/ospf6d.conf
      - r2/daemons:/etc/frr/daemons
      - r2/vtysh.conf:/etc/frr/vtysh.conf
      - r2/frr.log:/var/log/frr.log

      exec:
      - chown frr:frr /var/log/frr.log
    r3:
      kind: linux
      image: quay.io/frrouting/frr:8.5.0
      binds:
      - r3/zebra.conf:/etc/frr/zebra.conf
      - r3/bgpd.conf:/etc/frr/bgpd.conf
      - r3/ospfd.conf:/etc/frr/ospfd.conf
      - r3/ospf6d.conf:/etc/frr/ospf6d.conf
      - r3/daemons:/etc/frr/daemons
      - r3/vtysh.conf:/etc/frr/vtysh.conf
      - r3/frr.log:/var/log/frr.log

      exec:
      - chown frr:frr /var/log/frr.log
    r4:
      kind: linux
      image: quay.io/frrouting/frr:8.5.0
      binds:
      - r4/zebra.conf:/etc/frr/zebra.conf
      - r4/bgpd.conf:/etc/frr/bgpd.conf
      - r4/ospfd.conf:/etc/frr/ospfd.conf
      - r4/ospf6d.conf:/etc/frr/ospf6d.conf
      - r4/daemons:/etc/frr/daemons
      - r4/vtysh.conf:/etc/frr/vtysh.conf
      - r4/frr.log:/var/log/frr.log

      exec:
      - chown frr:frr /var/log/frr.log
    r5:
      kind: linux
      image: quay.io/frrouting/frr:8.5.0
      binds:
      - r5/zebra.conf:/etc/frr/zebra.conf
      - r5/bgpd.conf:/etc/frr/bgpd.conf
      - r5/ospfd.conf:/etc/frr/ospfd.conf
      - r5/ospf6d.conf:/etc/frr/ospf6d.conf
      - r5/daemons:/etc/frr/daemons
      - r5/vtysh.conf:/etc/frr/vtysh.conf
      - r5/frr.log:/var/log/frr.log

      exec:
      - chown frr:frr /var/log/frr.log
    sw0:
      kind: linux
      image: nicolaka/netshoot
      binds:
      - sw0/zebra.conf:/etc/frr/zebra.conf
      - sw0/bgpd.conf:/etc/frr/bgpd.conf
      - sw0/ospfd.conf:/etc/frr/ospfd.conf
      - sw0/ospf6d.conf:/etc/frr/ospf6d.conf
      - sw0/daemons:/etc/frr/daemons
      - sw0/vtysh.conf:/etc/frr/vtysh.conf
      - sw0/frr.log:/var/log/frr.log

      exec:
      - ip link add br0 type bridge
      - ip link set br0 up
      - ip link set dev net0 promisc on
      - ip link set dev net0 master br0
      - ip link set dev net1 promisc on
      - ip link set dev net1 master br0
    sw1:
      kind: linux
      image: nicolaka/netshoot
      binds:
      - sw1/zebra.conf:/etc/frr/zebra.conf
      - sw1/bgpd.conf:/etc/frr/bgpd.conf
      - sw1/ospfd.conf:/etc/frr/ospfd.conf
      - sw1/ospf6d.conf:/etc/frr/ospf6d.conf
      - sw1/daemons:/etc/frr/daemons
      - sw1/vtysh.conf:/etc/frr/vtysh.conf
      - sw1/frr.log:/var/log/frr.log

      exec:
      - ip link add br0 type bridge
      - ip link set br0 up
      - ip link set dev net0 promisc on
      - ip link set dev net0 master br0
      - ip link set dev net1 promisc on
      - ip link set dev net1 master br0
    sw10:
      kind: linux
      image: nicolaka/netshoot
      binds:
      - sw10/zebra.conf:/etc/frr/zebra.conf
      - sw10/bgpd.conf:/etc/frr/bgpd.conf
      - sw10/ospfd.conf:/etc/frr/ospfd.conf
      - sw10/ospf6d.conf:/etc/frr/ospf6d.conf
      - sw10/daemons:/etc/frr/daemons
      - sw10/vtysh.conf:/etc/frr/vtysh.conf
      - sw10/frr.log:/var/log/frr.log

      exec:
      - ip link add br0 type bridge
      - ip link set br0 up
      - ip link set dev net0 promisc on
      - ip link set dev net0 master br0
    sw2:
      kind: linux
      image: nicolaka/netshoot
      binds:
      - sw2/zebra.conf:/etc/frr/zebra.conf
      - sw2/bgpd.conf:/etc/frr/bgpd.conf
      - sw2/ospfd.conf:/etc/frr/ospfd.conf
      - sw2/ospf6d.conf:/etc/frr/ospf6d.conf
      - sw2/daemons:/etc/frr/daemons
      - sw2/vtysh.conf:/etc/frr/vtysh.conf
      - sw2/frr.log:/var/log/frr.log

      exec:
      - ip link add br0 type bridge
      - ip link set br0 up
      - ip link set dev net0 promisc on
      - ip link set dev net0 master br0
      - ip link set dev net1 promisc on
      - ip link set dev net1 master br0
    sw4:
      kind: linux
      image: nicolaka/netshoot
      binds:
      - sw4/zebra.conf:/etc/frr/zebra.conf
      - sw4/bgpd.conf:/etc/frr/bgpd.conf
      - sw4/ospfd.conf:/etc/frr/ospfd.conf
      - sw4/ospf6d.conf:/etc/frr/ospf6d.conf
      - sw4/daemons:/etc/frr/daemons
      - sw4/vtysh.conf:/etc/frr/vtysh.conf
      - sw4/frr.log:/var/log/frr.log

      exec:
      - ip link add br0 type bridge
      - ip link set br0 up
      - ip link set dev net0 promisc on
      - ip link set dev net0 master br0
      - ip link set dev net1 promisc on
      - ip link set dev net1 master br0
    sw5:
      kind: linux
      image: nicolaka/netshoot
      binds:
      - sw5/zebra.conf:/etc/frr/zebra.conf
      - sw5/bgpd.conf:/etc/frr/bgpd.conf
      - sw5/ospfd.conf:/etc/frr/ospfd.conf
      - sw5/ospf6d.conf:/etc/frr/ospf6d.conf
      - sw5/daemons:/etc/frr/daemons
      - sw5/vtysh.conf:/etc/frr/vtysh.conf
      - sw5/frr.log:/var/log/frr.log

      exec:
      - ip link add br0 type bridge
      - ip link set br0 up
      - ip link set dev net0 promisc on
      - ip link set dev net0 master br0
      - ip link set dev net1 promisc on
      - ip link set dev net1 master br0
    sw6:
      kind: linux
      image: nicolaka/netshoot
      binds:
      - sw6/zebra.conf:/etc/frr/zebra.conf
      - sw6/bgpd.conf:/etc/frr/bgpd.conf
      - sw6/ospfd.conf:/etc/frr/ospfd.conf
      - sw6/ospf6d.conf:/etc/frr/ospf6d.conf
      - sw6/daemons:/etc/frr/daemons
      - sw6/vtysh.conf:/etc/frr/vtysh.conf
      - sw6/frr.log:/var/log/frr.log

      exec:
      - ip link add br0 type bridge
      - ip link set br0 up
      - ip link set dev net0 promisc on
      - ip link set dev net0 master br0
    sw7:
      kind: linux
      image: nicolaka/netshoot
      binds:
      - sw7/zebra.conf:/etc/frr/zebra.conf
      - sw7/bgpd.conf:/etc/frr/bgpd.conf
      - sw7/ospfd.conf:/etc/frr/ospfd.conf
      - sw7/ospf6d.conf:/etc/frr/ospf6d.conf
      - sw7/daemons:/etc/frr/daemons
      - sw7/vtysh.conf:/etc/frr/vtysh.conf
      - sw7/frr.log:/var/log/frr.log

      exec:
      - ip link add br0 type bridge
      - ip link set br0 up
      - ip link set dev net0 promisc on
      - ip link set dev net0 master br0
    sw8:
      kind: linux
      image: nicolaka/netshoot
      binds:
      - sw8/zebra.conf:/etc/frr/zebra.conf
      - sw8/bgpd.conf:/etc/frr/bgpd.conf
      - sw8/ospfd.conf:/etc/frr/ospfd.conf
      - sw8/ospf6d.conf:/etc/frr/ospf6d.conf
      - sw8/daemons:/etc/frr/daemons
      - sw8/vtysh.conf:/etc/frr/vtysh.conf
      - sw8/frr.log:/var/log/frr.log

      exec:
      - ip link add br0 type bridge
      - ip link set br0 up
      - ip link set dev net0 promisc on
      - ip link set dev net0 master br0
    sw9:
      kind: linux
      image: nicolaka/netshoot
      binds:
      - sw9/zebra.conf:/etc/frr/zebra.conf
      - sw9/bgpd.conf:/etc/frr/bgpd.conf
      - sw9/ospfd.conf:/etc/frr/ospfd.conf
      - sw9/ospf6d.conf:/etc/frr/ospf6d.conf
      - sw9/daemons:/etc/frr/daemons
      - sw9/vtysh.conf:/etc/frr/vtysh.conf
      - sw9/frr.log:/var/log/frr.log

      exec:
      - ip link add br0 type bridge
      - ip link set br0 up
      - ip link set dev net0 promisc on
      - ip link set dev net0 master br0

  links:
  - endpoints: [r1:net0, sw0:net0]
  - endpoints: [r1:net1, sw2:net0]
  - endpoints: [r1:net2, sw4:net0]
  - endpoints: [r1:net3, sw6:net0]
  - endpoints: [r2:net0, sw0:net1]
  - endpoints: [r2:net1, sw1:net0]
  - endpoints: [r2:net2, sw5:net0]
  - endpoints: [r2:net3, sw7:net0]
  - endpoints: [r3:net0, sw1:net1]
  - endpoints: [r3:net1, sw2:net1]
  - endpoints: [r3:net2, sw8:net0]
  - endpoints: [r4:net0, sw4:net1]
  - endpoints: [r4:net1, sw9:net0]
  - endpoints: [r5:net0, sw10:net0]
  - endpoints: [r5:net1, sw5:net1]
