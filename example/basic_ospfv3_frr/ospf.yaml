global:
  path: local

ipspace:
  - name: ip
    range: fd00:1234::/32
    prefix: 64
    loopback_range: 10.255.0.0/24
    default_aware: true
    default_connect: true

nodeclass:
  - name: all
    config:
      - target: local
        template:
          - bash -c "enable_seg6_router.py | sh"
  - name: router
    primary: true
    tinet:
      image: slankdev/frr
    clab:
      kind: linux
      image: slankdev/frr
    config:
      - target: frr
        template: 
          - router ospf
          - ospf6 router-id {{ .ip_loopback }}
  - name: server
    primary: true
    tinet:
      image: slankdev/ubuntu:18.04
    clab:
      kind: linux
      image: slankdev/ubuntu:18.04

connectionclass:
  - name: default
    primary: true
    config:
      - target: local
        template:
          - ip -6 addr add {{ .ip_addr }}/{{ .ip_plen}} dev {{ .name }}
      - node: router
        target: frr
        template: 
          - router ospf
          - interface {{ .name }} area 0.0.0.0
      - node: server
        target: local
        template:
          - ip -6 route replace default via {{ .opp_ip_addr }}

