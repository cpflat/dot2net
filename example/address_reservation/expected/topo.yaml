name: address_reservation
topology:
  nodes:
    leaf1:
      kind: linux
      image: slankdev/frr
      binds:
      - 

      exec:
      - /usr/lib/frr/frr start
      - vtysh -c "conf t" -c "ip forwarding" -c "int lo" -c "ip addr 10.255.0.1/32" -c "router bgp 65000" -c "bgp router-id 10.255.0.1" -c "bgp bestpath as-path multipath-relax" -c "bgp bestpath compare-routerid"
      - vtysh -c "conf t" -c "int up1" -c "ip addr 10.0.0.2/30" -c "router bgp 65000" -c "neighbor 10.0.0.1 remote-as 65004"
      - vtysh -c "conf t" -c "int up2" -c "ip addr 10.0.4.2/30" -c "router bgp 65000" -c "neighbor 10.0.4.1 remote-as 65005"
      - vtysh -c "conf t" -c "int dn1" -c "ip addr 10.0.0.1/30" -c "router bgp 65000" -c "neighbor 10.0.0.2 remote-as 65006"
      - vtysh -c "conf t" -c "int dn2" -c "ip addr 10.0.0.5/30" -c "router bgp 65000" -c "neighbor 10.0.0.6 remote-as 65007"
    leaf2:
      kind: linux
      image: slankdev/frr
      binds:
      - 

      exec:
      - /usr/lib/frr/frr start
      - vtysh -c "conf t" -c "ip forwarding" -c "int lo" -c "ip addr 10.255.0.2/32" -c "router bgp 65001" -c "bgp router-id 10.255.0.2" -c "bgp bestpath as-path multipath-relax" -c "bgp bestpath compare-routerid"
      - vtysh -c "conf t" -c "int up1" -c "ip addr 10.0.1.2/30" -c "router bgp 65001" -c "neighbor 10.0.1.1 remote-as 65004"
      - vtysh -c "conf t" -c "int up2" -c "ip addr 10.0.5.2/30" -c "router bgp 65001" -c "neighbor 10.0.5.1 remote-as 65005"
      - vtysh -c "conf t" -c "int dn1" -c "ip addr 10.0.0.9/30" -c "router bgp 65001" -c "neighbor 10.0.0.10 remote-as 65008"
      - vtysh -c "conf t" -c "int dn2" -c "ip addr 10.0.0.13/30" -c "router bgp 65001" -c "neighbor 10.0.0.14 remote-as 65009"
    leaf3:
      kind: linux
      image: slankdev/frr
      binds:
      - 

      exec:
      - /usr/lib/frr/frr start
      - vtysh -c "conf t" -c "ip forwarding" -c "int lo" -c "ip addr 10.255.0.3/32" -c "router bgp 65002" -c "bgp router-id 10.255.0.3" -c "bgp bestpath as-path multipath-relax" -c "bgp bestpath compare-routerid"
      - vtysh -c "conf t" -c "int up1" -c "ip addr 10.0.2.2/30" -c "router bgp 65002" -c "neighbor 10.0.2.1 remote-as 65004"
      - vtysh -c "conf t" -c "int up2" -c "ip addr 10.0.6.2/30" -c "router bgp 65002" -c "neighbor 10.0.6.1 remote-as 65005"
      - vtysh -c "conf t" -c "int dn1" -c "ip addr 10.0.0.17/30" -c "router bgp 65002" -c "neighbor 10.0.0.18 remote-as 65010"
      - vtysh -c "conf t" -c "int dn2" -c "ip addr 10.0.0.21/30" -c "router bgp 65002" -c "neighbor 10.0.0.22 remote-as 65011"
    leaf4:
      kind: linux
      image: slankdev/frr
      binds:
      - 

      exec:
      - /usr/lib/frr/frr start
      - vtysh -c "conf t" -c "ip forwarding" -c "int lo" -c "ip addr 10.255.0.4/32" -c "router bgp 65003" -c "bgp router-id 10.255.0.4" -c "bgp bestpath as-path multipath-relax" -c "bgp bestpath compare-routerid"
      - vtysh -c "conf t" -c "int up1" -c "ip addr 10.0.3.2/30" -c "router bgp 65003" -c "neighbor 10.0.3.1 remote-as 65004"
      - vtysh -c "conf t" -c "int up2" -c "ip addr 10.0.7.2/30" -c "router bgp 65003" -c "neighbor 10.0.7.1 remote-as 65005"
      - vtysh -c "conf t" -c "int dn1" -c "ip addr 10.0.0.25/30" -c "router bgp 65003" -c "neighbor 10.0.0.26 remote-as 65012"
      - vtysh -c "conf t" -c "int dn2" -c "ip addr 10.0.0.29/30" -c "router bgp 65003" -c "neighbor 10.0.0.30 remote-as 65013"
    spine1:
      kind: linux
      image: slankdev/frr
      binds:
      - 

      exec:
      - /usr/lib/frr/frr start
      - vtysh -c "conf t" -c "ip forwarding" -c "int lo" -c "ip addr 10.255.0.5/32" -c "router bgp 65004" -c "bgp router-id 10.255.0.5" -c "bgp bestpath as-path multipath-relax" -c "bgp bestpath compare-routerid"
      - vtysh -c "conf t" -c "int dn1" -c "ip addr 10.0.0.1/30" -c "router bgp 65004" -c "neighbor 10.0.0.2 remote-as 65000"
      - vtysh -c "conf t" -c "int dn2" -c "ip addr 10.0.1.1/30" -c "router bgp 65004" -c "neighbor 10.0.1.2 remote-as 65001"
      - vtysh -c "conf t" -c "int dn3" -c "ip addr 10.0.2.1/30" -c "router bgp 65004" -c "neighbor 10.0.2.2 remote-as 65002"
      - vtysh -c "conf t" -c "int dn4" -c "ip addr 10.0.3.1/30" -c "router bgp 65004" -c "neighbor 10.0.3.2 remote-as 65003"
    spine2:
      kind: linux
      image: slankdev/frr
      binds:
      - 

      exec:
      - /usr/lib/frr/frr start
      - vtysh -c "conf t" -c "ip forwarding" -c "int lo" -c "ip addr 10.255.0.6/32" -c "router bgp 65005" -c "bgp router-id 10.255.0.6" -c "bgp bestpath as-path multipath-relax" -c "bgp bestpath compare-routerid"
      - vtysh -c "conf t" -c "int dn1" -c "ip addr 10.0.4.1/30" -c "router bgp 65005" -c "neighbor 10.0.4.2 remote-as 65000"
      - vtysh -c "conf t" -c "int dn2" -c "ip addr 10.0.5.1/30" -c "router bgp 65005" -c "neighbor 10.0.5.2 remote-as 65001"
      - vtysh -c "conf t" -c "int dn3" -c "ip addr 10.0.6.1/30" -c "router bgp 65005" -c "neighbor 10.0.6.2 remote-as 65002"
      - vtysh -c "conf t" -c "int dn4" -c "ip addr 10.0.7.1/30" -c "router bgp 65005" -c "neighbor 10.0.7.2 remote-as 65003"
    sv1:
      kind: linux
      image: slankdev/frr
      binds:
      - 

      exec:
      - /usr/lib/frr/frr start
      - vtysh -c "conf t" -c "ip forwarding" -c "int lo" -c "ip addr 10.255.0.7/32" -c "router bgp 65006" -c "bgp router-id 10.255.0.7" -c "bgp bestpath as-path multipath-relax" -c "bgp bestpath compare-routerid"
      - vtysh -c "conf t" -c "int net0" -c "ip addr 10.0.0.2/30" -c "router bgp 65006" -c "neighbor 10.0.0.1 remote-as external" -c "network 10.0.0.0/30"
    sv2:
      kind: linux
      image: slankdev/frr
      binds:
      - 

      exec:
      - /usr/lib/frr/frr start
      - vtysh -c "conf t" -c "ip forwarding" -c "int lo" -c "ip addr 10.255.0.8/32" -c "router bgp 65007" -c "bgp router-id 10.255.0.8" -c "bgp bestpath as-path multipath-relax" -c "bgp bestpath compare-routerid"
      - vtysh -c "conf t" -c "int net0" -c "ip addr 10.0.0.6/30" -c "router bgp 65007" -c "neighbor 10.0.0.5 remote-as external" -c "network 10.0.0.4/30"
    sv3:
      kind: linux
      image: slankdev/frr
      binds:
      - 

      exec:
      - /usr/lib/frr/frr start
      - vtysh -c "conf t" -c "ip forwarding" -c "int lo" -c "ip addr 10.255.0.9/32" -c "router bgp 65008" -c "bgp router-id 10.255.0.9" -c "bgp bestpath as-path multipath-relax" -c "bgp bestpath compare-routerid"
      - vtysh -c "conf t" -c "int net0" -c "ip addr 10.0.0.10/30" -c "router bgp 65008" -c "neighbor 10.0.0.9 remote-as external" -c "network 10.0.0.8/30"
    sv4:
      kind: linux
      image: slankdev/frr
      binds:
      - 

      exec:
      - /usr/lib/frr/frr start
      - vtysh -c "conf t" -c "ip forwarding" -c "int lo" -c "ip addr 10.255.0.10/32" -c "router bgp 65009" -c "bgp router-id 10.255.0.10" -c "bgp bestpath as-path multipath-relax" -c "bgp bestpath compare-routerid"
      - vtysh -c "conf t" -c "int net0" -c "ip addr 10.0.0.14/30" -c "router bgp 65009" -c "neighbor 10.0.0.13 remote-as external" -c "network 10.0.0.12/30"
    sv5:
      kind: linux
      image: slankdev/frr
      binds:
      - 

      exec:
      - /usr/lib/frr/frr start
      - vtysh -c "conf t" -c "ip forwarding" -c "int lo" -c "ip addr 10.255.0.11/32" -c "router bgp 65010" -c "bgp router-id 10.255.0.11" -c "bgp bestpath as-path multipath-relax" -c "bgp bestpath compare-routerid"
      - vtysh -c "conf t" -c "int net0" -c "ip addr 10.0.0.18/30" -c "router bgp 65010" -c "neighbor 10.0.0.17 remote-as external" -c "network 10.0.0.16/30"
    sv6:
      kind: linux
      image: slankdev/frr
      binds:
      - 

      exec:
      - /usr/lib/frr/frr start
      - vtysh -c "conf t" -c "ip forwarding" -c "int lo" -c "ip addr 10.255.0.12/32" -c "router bgp 65011" -c "bgp router-id 10.255.0.12" -c "bgp bestpath as-path multipath-relax" -c "bgp bestpath compare-routerid"
      - vtysh -c "conf t" -c "int net0" -c "ip addr 10.0.0.22/30" -c "router bgp 65011" -c "neighbor 10.0.0.21 remote-as external" -c "network 10.0.0.20/30"
    sv7:
      kind: linux
      image: slankdev/frr
      binds:
      - 

      exec:
      - /usr/lib/frr/frr start
      - vtysh -c "conf t" -c "ip forwarding" -c "int lo" -c "ip addr 10.255.0.13/32" -c "router bgp 65012" -c "bgp router-id 10.255.0.13" -c "bgp bestpath as-path multipath-relax" -c "bgp bestpath compare-routerid"
      - vtysh -c "conf t" -c "int net0" -c "ip addr 10.0.0.26/30" -c "router bgp 65012" -c "neighbor 10.0.0.25 remote-as external" -c "network 10.0.0.24/30"
    sv8:
      kind: linux
      image: slankdev/frr
      binds:
      - 

      exec:
      - /usr/lib/frr/frr start
      - vtysh -c "conf t" -c "ip forwarding" -c "int lo" -c "ip addr 10.255.0.14/32" -c "router bgp 65013" -c "bgp router-id 10.255.0.14" -c "bgp bestpath as-path multipath-relax" -c "bgp bestpath compare-routerid"
      - vtysh -c "conf t" -c "int net0" -c "ip addr 10.0.0.30/30" -c "router bgp 65013" -c "neighbor 10.0.0.29 remote-as external" -c "network 10.0.0.28/30"

  links:
  - endpoints: [spine1:dn1, leaf1:up1]
  - endpoints: [spine2:dn1, leaf1:up2]
  - endpoints: [leaf1:dn1, sv1:net0]
  - endpoints: [leaf1:dn2, sv2:net0]
  - endpoints: [spine1:dn2, leaf2:up1]
  - endpoints: [spine2:dn2, leaf2:up2]
  - endpoints: [leaf2:dn1, sv3:net0]
  - endpoints: [leaf2:dn2, sv4:net0]
  - endpoints: [spine1:dn3, leaf3:up1]
  - endpoints: [spine2:dn3, leaf3:up2]
  - endpoints: [leaf3:dn1, sv5:net0]
  - endpoints: [leaf3:dn2, sv6:net0]
  - endpoints: [spine1:dn4, leaf4:up1]
  - endpoints: [spine2:dn4, leaf4:up2]
  - endpoints: [leaf4:dn1, sv7:net0]
  - endpoints: [leaf4:dn2, sv8:net0]
