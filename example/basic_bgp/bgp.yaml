name: bgp

file:
  - name: daemons
    path: /etc/frr/daemons
  - name: vtysh.conf
    path: /etc/frr/vtysh.conf

ipspace:
  - name: ip
    range: 10.0.0.0/16
    prefix: 24
    loopback_range: 10.255.0.0/24
    default_aware: true
    default_connect: true

nodeclass:
  - name: default
    primary: true
    tinet:
      image: quay.io/frrouting/frr:8.5.0
    clab:
      kind: linux
      image: quay.io/frrouting/frr:8.5.0
    config:
      - file: daemons
        sourcefile: ./daemons
      - file: vtysh.conf
        sourcefile: ./vtysh.conf
      - style: frr-vtysh
        template:
          - router bgp {{ .group_as }}
          - bgp router-id {{ .ip_loopback }}

connectionclass:
  - name: default
    primary: true
    config:
      - style: frr-vtysh
        template: 
          - int {{ .name }}
          - ip addr {{ .ip_addr }}/{{ .ip_plen }}
          - router bgp {{ .group_as }}
          - neighbor {{ .opp_ip_addr }} remote-as {{ .opp_group_as }}

groupclass:
  - name: as
    numbered: [as]

